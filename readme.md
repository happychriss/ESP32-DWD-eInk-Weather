# ESP32 - eInk LilyGo T5 4.7  Weather Application using DWD (Deutscher Wetterdienst) OpenData

This repository contains a Proof of Concept (POC) application designed to be integrated into the [Goodwatch](https://44-2.de/goodwatch-eink-alarm-clock-with-voice-recognition/) project, a smart e-ink watch that can be programmed with voice commands. The application, written in C++, is targeted for the ESP32 platform and is capable of downloading weather data from the Deutscher Wetterdienst (DWD). The DWD provides weather forecasts in KML format, which are complex XML structures available as zip-packed files. The application leverages a 4.7 Inch E-paper eInk display (T5) and utilizes the deep sleep mode of the ESP32, waking up based on the RTC clock.

(This readme was generated by ChatGPT - thanks my friend - I hate writing this stuff) 

## Features

- Downloads weather data from DWD's [MOSMIX_L](https://opendata.dwd.de/weather/local_forecasts/mos/MOSMIX_L/single_stations/) using a WiFi connection.
- Retrieves multi-day weather forecasts in hourly intervals.
- Utilizes the [miniz library](https://github.com/richgel999/miniz) to unpack the downloaded KML file.
- Parses the KML using [pugixml](https://github.com/zeux/pugixml) to extract forecast data.
- Displays weather information on the eInk display with weather icons and text.
- Supports warnings for extreme or special weather conditions using special codes from DWD.

Note: As this is a POC only - the code is not optimized or well-structured. 
It is recommended to use this code as a starting point and adapt it to your needs.

## Setup

To integrate this application into the "Goodwatch" project, follow these steps:

1. Clone this repository to your local machine.
2. Ensure you have the ESP32 development environment set up, along with [PlatformIO](https://platformio.org/).
3. Modify the `weather.h` file to add the specific weather station link for your desired location. Information about the file format and finding weather stations can be found [here](https://www.dwd.de/DE/leistungen/opendata/hilfe.html).
4. Adjust the e-ink driver files from [LilyGo-EPD47](https://github.com/Xinyuan-LilyGO/LilyGo-EPD47/tree/master/examples/demo) according to your needs.
5. If you want different icons, run the Python script `image_batch_convert.py` to convert icons from the [weather-underground-icons](https://github.com/manifestinteractive/weather-underground-icons) repository into header files.
6. If you wnat to check the downloaded file for debugging, use the `download_fs.py` script to download the SPIFF file system to a local folder.

## Additional Resources

- [Deutscher Wetterdienst (DWD) OpenData](https://www.dwd.de/DE/leistungen/opendata/hilfe.html)
- [miniz library](https://github.com/richgel999/miniz)
- [pugixml](https://github.com/zeux/pugixml)
- [LilyGo-EPD47 e-ink driver](https://github.com/Xinyuan-LilyGO/LilyGo-EPD47/tree/master/examples/demo)
- [weather-underground-icons](https://github.com/manifestinteractive/weather-underground-icons)

## License

This project is licensed under the [MIT License](LICENSE). Feel free to use and modify it according to your needs.

## Disclaimer

This application is a Proof of Concept (POC) and may require adjustments to integrate with specific hardware or project requirements. Use it as a starting point and adapt it as necessary for your application. The links provided in the original project are included as-is and should not be changed.

For any questions or support, feel free to reach out to the contributors of this repository.